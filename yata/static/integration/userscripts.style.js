
// YATA icons
var iconNeutral = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjUuMjc1bW0iIGhlaWdodD0iOS4yMjQ4bW0iIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI1LjI3NSA5LjIyNDgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMTcuNTkgLTEyNi4zOCkiPgogIDxnIHRyYW5zZm9ybT0ibWF0cml4KC4xMDI1IDAgMCAuMTAyNSAtMTA1LjU0IDEyMS43MSkiPgogICA8cGF0aCBkPSJtLTc5LjE1NiA4Ni4zNTEgMTcuNTQ4LTM4Ljc1NWgxOC45OTZsLTI3LjY4MyA1NC44MjR2MzEuMTkzaC0xNy42NjR2LTMxLjE5M2wtMjcuNjgzLTU0LjgyNGgxOS4wNTR6IiBmaWxsPSIjNDQ3ZTliIiBzdHJva2U9IiM0MTRjNTEiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIzLjk0MjIiIHN0eWxlPSJwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlIi8+CiAgPC9nPgogIDxnIGZpbGw9IiM0NDdlOWIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+CiAgIDxnIHRyYW5zZm9ybT0ibWF0cml4KC4xMDE0NiAwIDAgLjEwMzUgLTExMC41NyAxMjEuNzEpIiBzdHJva2U9IiM0MTRjNTEiIHN0cm9rZS13aWR0aD0iMy45NDMxIiBzdHlsZT0icGFpbnQtb3JkZXI6bWFya2VycyBmaWxsIHN0cm9rZSIgYXJpYS1sYWJlbD0iVCI+CiAgICA8cGF0aCBkPSJtMTE2LjM2IDYxLjI5MWgtMjYuMDk0djcwLjk2OGgtMTcuNTUydi03MC45NjhoLTI1Ljc0M3YtMTQuMjE3aDY5LjM4OHoiIGZpbGw9IiM0NDdlOWIiIHN0cm9rZT0iIzQxNGM1MSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjMuOTQzMSIgc3R5bGU9InBhaW50LW9yZGVyOm1hcmtlcnMgZmlsbCBzdHJva2UiLz4KICAgPC9nPgogICA8ZyB0cmFuc2Zvcm09Im1hdHJpeCguMTAxNDYgMCAwIC4xMDM1IC0xMDcuNDkgMTIxLjcxKSIgc3Ryb2tlPSIjNDU1MjU4IiBzdHJva2Utd2lkdGg9IjMuOTQzNSIgc3R5bGU9InBhaW50LW9yZGVyOm1hcmtlcnMgZmlsbCBzdHJva2UiIGFyaWEtbGFiZWw9IkEiPgogICAgPHBhdGggZD0ibTExLjA4OCAxMTQuNzFoLTMwLjc3NGwtNS44NTA2IDE3LjU1MmgtMTguNjYzbDMxLjcxLTg1LjE4NGgxNi4yNjVsMzEuODg2IDg1LjE4NGgtMTguNjYzem0tMjYuMDM1LTE0LjIxN2gyMS4yOTZsLTEwLjcwNy0zMS44ODZ6IiBmaWxsPSIjNDQ3ZTliIiBzdHJva2U9IiM0NTUyNTgiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIzLjk0MzUiIHN0eWxlPSJwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlIi8+CiAgIDwvZz4KICAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoLjEwMTQ2IDAgMCAuMTAzNSAtMTEzLjA3IDEyMS43MSkiIHN0cm9rZT0iIzQxNGM1MSIgc3Ryb2tlLXdpZHRoPSIzLjk0MzEiIHN0eWxlPSJwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlIiBhcmlhLWxhYmVsPSJBIj4KICAgIDxwYXRoIGQ9Im0xNzcuOTcgMTE0LjcxaC0zMC43NzRsLTUuODUwNiAxNy41NTJoLTE4LjY2M2wzMS43MS04NS4xODVoMTYuMjY1bDMxLjg4NiA4NS4xODVoLTE4LjY2M3ptLTI2LjAzNS0xNC4yMTdoMjEuMjk2bC0xMC43MDctMzEuODg2eiIgZmlsbD0iIzQ0N2U5YiIgc3Ryb2tlPSIjNDE0YzUxIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMy45NDMxIiBzdHlsZT0icGFpbnQtb3JkZXI6bWFya2VycyBmaWxsIHN0cm9rZSIvPgogICA8L2c+CiAgPC9nPgogPC9nPgo8L3N2Zz4K"
var iconValid = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgaWQ9InN2ZzIyIgogICB2aWV3Qm94PSIwIDAgMjUuMjc1IDkuMjI0OCIKICAgdmVyc2lvbj0iMS4xIgogICBoZWlnaHQ9IjkuMjI0OG1tIgogICB3aWR0aD0iMjUuMjc1bW0iPgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTI4Ij4KICAgIDxyZGY6UkRGPgogICAgICA8Y2M6V29yawogICAgICAgICByZGY6YWJvdXQ9IiI+CiAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+CiAgICAgICAgPGRjOnR5cGUKICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIiAvPgogICAgICAgIDxkYzp0aXRsZT48L2RjOnRpdGxlPgogICAgICA8L2NjOldvcms+CiAgICA8L3JkZjpSREY+CiAgPC9tZXRhZGF0YT4KICA8ZGVmcwogICAgIGlkPSJkZWZzMjYiIC8+CiAgPGcKICAgICBpZD0iZzIwIgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDExNy41OSAtMTI2LjM4KSI+CiAgICA8ZwogICAgICAgc3R5bGU9ImZpbGw6IzE4YTgyMTtmaWxsLW9wYWNpdHk6MSIKICAgICAgIGlkPSJnNCIKICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KC4xMDI1IDAgMCAuMTAyNSAtMTA1LjU0IDEyMS43MSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDIiCiAgICAgICAgIHN0eWxlPSJwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlO2ZpbGw6IzE4YTgyMTtmaWxsLW9wYWNpdHk6MSIKICAgICAgICAgc3Ryb2tlLXdpZHRoPSIzLjk0MjIiCiAgICAgICAgIHN0cm9rZS1saW5lam9pbj0icm91bmQiCiAgICAgICAgIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIKICAgICAgICAgc3Ryb2tlPSIjNDE0YzUxIgogICAgICAgICBmaWxsPSIjNDQ3ZTliIgogICAgICAgICBkPSJtLTc5LjE1NiA4Ni4zNTEgMTcuNTQ4LTM4Ljc1NWgxOC45OTZsLTI3LjY4MyA1NC44MjR2MzEuMTkzaC0xNy42NjR2LTMxLjE5M2wtMjcuNjgzLTU0LjgyNGgxOS4wNTR6IiAvPgogICAgPC9nPgogICAgPGcKICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KDAuMTAxNDYsMCwwLDAuMTAzNSwtMTEwLjU3LDEyMS43MSkiCiAgICAgICBzdHlsZT0iZmlsbDojMThhODIxO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojNDE0YzUxO3N0cm9rZS13aWR0aDozLjk0MzA5OTk4O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlIgogICAgICAgYXJpYS1sYWJlbD0iVCIKICAgICAgIGlkPSJnOCI+CiAgICAgIDxwYXRoCiAgICAgICAgIGQ9Ik0gMTE2LjM2LDYxLjI5MSBIIDkwLjI2NiB2IDcwLjk2OCBIIDcyLjcxNCBWIDYxLjI5MSBIIDQ2Ljk3MSBWIDQ3LjA3NCBoIDY5LjM4OCB6IgogICAgICAgICBzdHlsZT0iZmlsbDojMThhODIxO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojNDE0YzUxO3N0cm9rZS13aWR0aDozLjk0MzA5OTk4O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlIgogICAgICAgICBpZD0icGF0aDYiIC8+CiAgICA8L2c+CiAgICA8ZwogICAgICAgdHJhbnNmb3JtPSJtYXRyaXgoMC4xMDE0NiwwLDAsMC4xMDM1LC0xMDcuNDksMTIxLjcxKSIKICAgICAgIHN0eWxlPSJmaWxsOiMxOGE4MjE7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiM0NTUyNTg7c3Ryb2tlLXdpZHRoOjMuOTQzNTAwMDQ7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3BhaW50LW9yZGVyOm1hcmtlcnMgZmlsbCBzdHJva2UiCiAgICAgICBhcmlhLWxhYmVsPSJBIgogICAgICAgaWQ9ImcxMiI+CiAgICAgIDxwYXRoCiAgICAgICAgIGQ9Im0gMTEuMDg4LDExNC43MSBoIC0zMC43NzQgbCAtNS44NTA2LDE3LjU1MiBoIC0xOC42NjMgbCAzMS43MSwtODUuMTg0IGggMTYuMjY1IGwgMzEuODg2LDg1LjE4NCBIIDE2Ljk5ODQgWiBNIC0xNC45NDcsMTAwLjQ5MyBIIDYuMzQ5IEwgLTQuMzU4LDY4LjYwNyBaIgogICAgICAgICBzdHlsZT0iZmlsbDojMThhODIxO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojNDU1MjU4O3N0cm9rZS13aWR0aDozLjk0MzUwMDA0O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlIgogICAgICAgICBpZD0icGF0aDEwIiAvPgogICAgPC9nPgogICAgPGcKICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KDAuMTAxNDYsMCwwLDAuMTAzNSwtMTEzLjA3LDEyMS43MSkiCiAgICAgICBzdHlsZT0iZmlsbDojMThhODIxO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojNDE0YzUxO3N0cm9rZS13aWR0aDozLjk0MzA5OTk4O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlIgogICAgICAgYXJpYS1sYWJlbD0iQSIKICAgICAgIGlkPSJnMTYiPgogICAgICA8cGF0aAogICAgICAgICBkPSJtIDE3Ny45NywxMTQuNzEgaCAtMzAuNzc0IGwgLTUuODUwNiwxNy41NTIgaCAtMTguNjYzIGwgMzEuNzEsLTg1LjE4NSBoIDE2LjI2NSBsIDMxLjg4Niw4NS4xODUgaCAtMTguNjYzIHogbSAtMjYuMDM1LC0xNC4yMTcgaCAyMS4yOTYgTCAxNjIuNTI0LDY4LjYwNyBaIgogICAgICAgICBzdHlsZT0iZmlsbDojMThhODIxO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojNDE0YzUxO3N0cm9rZS13aWR0aDozLjk0MzA5OTk4O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlIgogICAgICAgICBpZD0icGF0aDE0IiAvPgogICAgPC9nPgogIDwvZz4KPC9zdmc+Cg=="
var iconError = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgaWQ9InN2ZzExNTkiCiAgIHZpZXdCb3g9IjAgMCAyNS4yNzUgOS4yMjQ4IgogICB2ZXJzaW9uPSIxLjEiCiAgIGhlaWdodD0iOS4yMjQ4bW0iCiAgIHdpZHRoPSIyNS4yNzVtbSI+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhMTE2NSI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgICA8ZGM6dGl0bGU+PC9kYzp0aXRsZT4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGRlZnMKICAgICBpZD0iZGVmczExNjMiIC8+CiAgPGcKICAgICBpZD0iZzExNTciCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTE3LjU5IC0xMjYuMzgpIj4KICAgIDxnCiAgICAgICBpZD0iZzExNDMiCiAgICAgICBzdHlsZT0iZmlsbDojZGI2MDUxIgogICAgICAgdHJhbnNmb3JtPSJtYXRyaXgoLjEwMjUgMCAwIC4xMDI1IC0xMDUuNTQgMTIxLjcxKSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMTE0MSIKICAgICAgICAgc3R5bGU9ImZpbGw6I2RiNjA1MTtwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlIgogICAgICAgICBzdHJva2Utd2lkdGg9IjMuOTQyMiIKICAgICAgICAgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIKICAgICAgICAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogICAgICAgICBzdHJva2U9IiM0MTRjNTEiCiAgICAgICAgIGZpbGw9IiM0NDdlOWIiCiAgICAgICAgIGQ9Im0tNzkuMTU2IDg2LjM1MSAxNy41NDgtMzguNzU1aDE4Ljk5NmwtMjcuNjgzIDU0LjgyNHYzMS4xOTNoLTE3LjY2NHYtMzEuMTkzbC0yNy42ODMtNTQuODI0aDE5LjA1NHoiIC8+CiAgICA8L2c+CiAgICA8ZwogICAgICAgaWQ9ImcxMTQ3IgogICAgICAgc3R5bGU9ImZpbGw6I2RiNjA1MTtwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6My45NDMxO3N0cm9rZTojNDE0YzUxIgogICAgICAgdHJhbnNmb3JtPSJtYXRyaXgoLjEwMTQ2IDAgMCAuMTAzNSAtMTEwLjU3IDEyMS43MSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDExNDUiCiAgICAgICAgIHN0eWxlPSJmaWxsOiNkYjYwNTE7cGFpbnQtb3JkZXI6bWFya2VycyBmaWxsIHN0cm9rZTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLXdpZHRoOjMuOTQzMTtzdHJva2U6IzQxNGM1MSIKICAgICAgICAgZD0ibTExNi4zNiA2MS4yOTFoLTI2LjA5NHY3MC45NjhoLTE3LjU1MnYtNzAuOTY4aC0yNS43NDN2LTE0LjIxN2g2OS4zODh6IiAvPgogICAgPC9nPgogICAgPGcKICAgICAgIGlkPSJnMTE1MSIKICAgICAgIHN0eWxlPSJmaWxsOiNkYjYwNTE7cGFpbnQtb3JkZXI6bWFya2VycyBmaWxsIHN0cm9rZTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLXdpZHRoOjMuOTQzNTtzdHJva2U6IzQ1NTI1OCIKICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KC4xMDE0NiAwIDAgLjEwMzUgLTEwNy40OSAxMjEuNzEpIj4KICAgICAgPHBhdGgKICAgICAgICAgaWQ9InBhdGgxMTQ5IgogICAgICAgICBzdHlsZT0iZmlsbDojZGI2MDUxO3BhaW50LW9yZGVyOm1hcmtlcnMgZmlsbCBzdHJva2U7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS13aWR0aDozLjk0MzU7c3Ryb2tlOiM0NTUyNTgiCiAgICAgICAgIGQ9Im0xMS4wODggMTE0LjcxaC0zMC43NzRsLTUuODUwNiAxNy41NTJoLTE4LjY2M2wzMS43MS04NS4xODRoMTYuMjY1bDMxLjg4NiA4NS4xODRoLTE4LjY2M3ptLTI2LjAzNS0xNC4yMTdoMjEuMjk2bC0xMC43MDctMzEuODg2eiIgLz4KICAgIDwvZz4KICAgIDxnCiAgICAgICBpZD0iZzExNTUiCiAgICAgICBzdHlsZT0iZmlsbDojZGI2MDUxO3BhaW50LW9yZGVyOm1hcmtlcnMgZmlsbCBzdHJva2U7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS13aWR0aDozLjk0MzE7c3Ryb2tlOiM0MTRjNTEiCiAgICAgICB0cmFuc2Zvcm09Im1hdHJpeCguMTAxNDYgMCAwIC4xMDM1IC0xMTMuMDcgMTIxLjcxKSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMTE1MyIKICAgICAgICAgc3R5bGU9ImZpbGw6I2RiNjA1MTtwYWludC1vcmRlcjptYXJrZXJzIGZpbGwgc3Ryb2tlO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6My45NDMxO3N0cm9rZTojNDE0YzUxIgogICAgICAgICBkPSJtMTc3Ljk3IDExNC43MWgtMzAuNzc0bC01Ljg1MDYgMTcuNTUyaC0xOC42NjNsMzEuNzEtODUuMTg1aDE2LjI2NWwzMS44ODYgODUuMTg1aC0xOC42NjN6bS0yNi4wMzUtMTQuMjE3aDIxLjI5NmwtMTAuNzA3LTMxLjg4NnoiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"

var icon = '<a href="https://yata.alwaysdata.net/" target="_blank"><img id="YATA-icon" class="YATA-icon" alt="YATA icon" src="'+iconNeutral+'"></a>'
var infobox = '<div id="YATA-infobox" class="m-bottom10"><div id="YATA-status">'+icon+'</div><div id="YATA-message"><div id="YATA-message-buttons"></div><div id="YATA-message-text"></div></div></div><div class="clear"></div><hr class="page-head-delimiter">';

// parse cookie
const getCookie = (s)=>{
    let parse=RegExp(""+s+"[^;]+").exec(document.cookie);
    return decodeURIComponent(!!parse ? parse.toString().replace(/^[^=]+./,"") : "");
};

const setIcon = (type) => {
  // valid case
  if(type == 1) { $("#YATA-icon").attr("src", iconValid); }
  // error case
  else if (type == -1) { $("#YATA-icon").attr("src", iconError); }
  // neutral
  else { $("#YATA-icon").attr("src", iconNeutral); }
}

// Msgbox
const msgbox = (msg)=>{
    $("#YATA-message-text").html(msg);
    setIcon(0);
};

// Response OK
const valid = (msg)=>{
    msgbox("<b>" + msg +"</b>");
    setIcon(1);
};

const error = (msg)=>{
    msgbox('<b><span class="error">Error</span>: '+msg+'</b>');
    setIcon(-1);
};

// API Key
const errorKey = (msg, good)=>{
    let key = GM_getValue("key","");
    if (key == "") {
        key = "Insert API Key";
        msg = "No API Key stored.";
        good = false;
    }
    if (good)
        msgbox("Stored key");
    else
        error(msg+' Retype <a href="https://www.torn.com/preferences.php#tab=api" target="_blank" class="YATA-link">key</a>:');

    // define input
    let input = $('<input id="YATA-api-key" class="YATA-input">')
    if (good)
        input.val(key);
    else
        input.attr("placeholder", key);

    // // define store button
    // let button = $('<button id="YATA-api-key-store" class="YATA-button">');
    // button.text("Store");

    // action store button
    input.change(()=>{
        let key = $("#YATA-api-key").val();
        GM_setValue("key", key);
        if (key.length != 16)
            return errorKey("Key is not the correct length.");
        valid("Key stored, ready to submit.")
        $("#YATA-api-key").remove();
        // $("#YATA-api-key-store").remove();
    });

    // display buttons
    if(!$("#YATA-api-key").length){
      $("#YATA-message").append(input);
    }
}
